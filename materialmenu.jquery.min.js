/**
 * Available for use under the MIT License (http://en.wikipedia.org/wiki/MIT_License)
 * 
 * Copyright (c) 2014 by Adam Banaszkiewicz
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 * @version 0.0.1
 * @date    2014.11.02
 * @author  Adam Banaszkiewicz
 */
(function(e){e.fn.materialmenu=function(t){var t=e.extend({mobileWidth:768,width:250,animationTime:200,overlayOpacity:.4,buttonClass:"material-menu-button",buttonHTML:'<div class="material-menu-button"><span></span><span></span><span></span></div>',title:"",showTitle:false,titleShowOn:40,onOpen:function(e){},onClose:function(e){},onChangeMobile:function(e){e.parent().parent().addClass("vertical")},onChangeDesktop:function(e){e.parent().parent().removeClass("vertical")},onShowTitlebar:function(e){},onHideTitlebar:function(e){}},t);var n=function(t,n){this.options=n;this.element=t;this.overlay=e([]);this.title=e([]);this.isTitleShowed=false;this.isShowed=false;this.changedOnMobile=false;this.changedOnDesktop=false;this.init=function(){var t=this;this.prepare();this.showMenuDependentByWidth();this.bindEvents();e(window).resize(function(){t.showMenuDependentByWidth()})};this.prepare=function(){this.element.wrap(e("<div />",{"class":"material-menu-wrapper"}));if(this.options.showTitle){var t=e(".material-menu-titlebar");if(t.length==0){e("<div />",{"class":"material-menu-titlebar",style:"display:block;position:fixed;left:0px;top:0px;width:100%;height:55px;background-color:#fff;z-index:999998;"}).appendTo("body");this.title=e(".material-menu-titlebar");this.title.append(e(this.options.buttonHTML).addClass(this.options.buttonClass).css({"float":"left",margin:"5px"}));this.title.append('<div class="material-menu-title" style="float:left;line-height:55px;height:55px;margin-left:10px;">'+this.options.title+"</div>");if(this.options.titleShowOn==0)this.showTitle();else this.hideTitle()}else{this.title=t}}var n=e(".material-menu-overlay");if(n.length==1){this.overlay=n}else{e("<div />",{"class":"material-menu-overlay",style:"display:block;position:fixed;left:0px;top:0px;width:100%;height:100%;z-index:999998;background-color:#000000;"}).appendTo("body");this.overlay=e(".material-menu-overlay")}this.overlay.fadeTo(0,0).css("display","none")};this.bindEvents=function(){var t=this;e("."+this.options.buttonClass).click(function(){if(t.isShowed)t.close();else t.open()});this.overlay.click(function(){t.close()});e(window).scroll(function(){if(e(this).scrollTop()>=t.options.titleShowOn)t.showTitle();else t.hideTitle()})};this.showMenuDependentByWidth=function(){if(this.getWindowWidth()<=this.options.mobileWidth)this.showForMobile();else this.showForDesktop();if(this.isShowed)this.close()};this.showForMobile=function(){if(this.changedOnMobile==false){this.element.parent().removeClass("material-menu-view-desktop").addClass("material-menu-view-mobile").css({display:"none",position:"fixed",top:"0px",zIndex:"999999",overflow:"auto",height:"100%",width:this.getMenuWidth()+"px",left:"-"+this.getMenuWidth()+"px"});if(this.options.showTitle){this.title.show()}this.changedOnDesktop=false;this.changedOnMobile=true;this.options.onChangeMobile(this.element)}};this.showForDesktop=function(){if(this.changedOnDesktop==false){this.element.parent().removeClass("material-menu-view-mobile").addClass("material-menu-view-desktop").css({display:"block",position:"static",top:"auto",zIndex:"auto",overflow:"visible",height:"auto",width:"auto",left:"auto"});if(this.options.showTitle){this.title.hide()}this.changedOnDesktop=true;this.changedOnMobile=false;this.options.onChangeDesktop(this.element)}};this.open=function(){var t=this;if(t.isShowed==false&&t.getWindowWidth()<=t.options.mobileWidth){t.isShowed=true;t.element.parent().show().animate({left:"0px"},t.options.animationTime);t.overlay.css("display","block").fadeTo(t.options.animationTime,t.options.overlayOpacity);e("body").css("overflow","hidden");t.options.onOpen(t.element)}};this.close=function(){var t=this;if(t.isShowed==true){t.isShowed=false;t.element.parent().animate({left:"-"+t.getMenuWidth()+"px"},t.options.animationTime,function(){e(this).hide()});t.overlay.fadeTo(t.options.animationTime,0,function(){e(this).css("display","none");t.options.onClose(t.element)});e("body").css("overflow","auto")}};this.showTitle=function(){if(this.isTitleShowed==false&&this.changedOnMobile==true){this.title.show().fadeTo(this.options.animationTime,1);this.isTitleShowed=true;this.options.onShowTitlebar(this.title)}};this.hideTitle=function(){if(this.isTitleShowed==true){this.title.fadeTo(this.options.animationTime,0,function(){e(this).hide()});this.isTitleShowed=false;this.options.onHideTitlebar(this.title)}};this.getMenuWidth=function(){return this.options.width};this.getWindowWidth=function(){if(typeof window.innerWidth=="number")return window.innerWidth;else if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight))return document.documentElement.clientWidth;else if(document.body&&(document.body.clientWidth||document.body.clientHeight))return document.body.clientWidth;else return e("body, html").width()}};return e(this).each(function(){var r=new n(e(this),t);r.init()})}})(jQuery)